{% extends 'home/header.htm' %}
{% load static %}
{% load humanize %}
{% block title %}稟議{% endblock %}
{% block content %}

<div class="container">
    <div class="row mt-3">
        <div class="col-md-12">
            <h4><i class="fas fa-hand-holding-usd"></i> 稟議申請</h4>
            <p>新しく稟議を申請するには、「申請する」ボタンを押してください。</p>
        </div>
    </div>

    <div class="row m-1">
        <div class="col-md-2 shadow">
            <p><button type="button" class="btn btn-primary btn-block mt-2" onclick="location.href='{% url 'ringi.create' %}'">申請する</button></p>
            <li class="list-unstyled"><strong>状況</strong></li>
            <li class="list-unstyled"><a href="">✔未完了</a> 6件</li>
            <li class="list-unstyled"><a href="">申請中</a> 3件</li>
            <li class="list-unstyled"><a href="">承認済</a> 5件</li>
            <li class="list-unstyled"><a href="">✔完了</a></li>
        </div>

        <div class="col-md-10">
            <p>12件のレコード</p>
            <div class="table-responsive">
                <table class="table table-hover table-sm">
                    <thead class="thead-light">
                        <tr class="info">
                            <th width=1px></th>
                            <th width=1px></th>
                            <th>品目</th>
                            <th>状況</th>
                            <th>金額</th>
                            <th>申請者</th>
                            <th>申請日</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for ringi in ringis %}
                            <tr>
                                <!-- url 'edit' item.id -->
                                <!-- url 'delete' item.id -->
                                <td>
                                    {% if perms.ringi.change_ringi %}
                                    <a href="" style="text-decoration: none;">⛏</a>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if perms.ringi.delete_ringi %}
                                    <a href="" style="text-decoration: none;">❌</a>
                                    {% endif %}
                                </td>
                                <td>{{ ringi.title }}</td>

                                {# ここで条件分岐して色分けを行うのではなく、ステータスが直接CSSクラスの情報を持つほうがよさそう #}
                                {% if ringi.status.state_type == '申請中' %}
                                    <td class="table-danger">{{ ringi.status.state_type }}</td>
                                {% elif ringi.status.state_type == '承認済' %}
                                    <td class="table-secondary">{{ ringi.status.state_type }}</td>
                                {% else %}
                                    <td>{{ ringi.status.state_type }}</td>
                                {% endif %}

                                <td class="text-right">{{ ringi.price | intcomma }} 円</td>
                                <td>{{ ringi.owner }}</td>
                                <td>{{ ringi.created_at | naturalday }}</td>
                        {% endfor %}
                        {# 表示例 #}
                        <!--
                            <tr><td><a href="">Edit</a></td><td><a href="">Delete</a></td><td>液晶タブレット</td><td class="table-danger">申請中</td><td class="text-right">990 円</td><td>Muramatsu</td><td>2020/02/25</td></tr>
                            <tr><td><a href="">Edit</a></td><td><a href="">Delete</a></td><td>ドメイン更新料</td><td class="table-secondary">承認済</td><td class="text-right">1,860 円</td><td>Mogami</td><td>2020/01/07</td></tr>
                            <tr><td><a href="">Edit</a></td><td><a href="">Delete</a></td><td>HDMI-VGAアダプタ</td><td class="table-secondary">承認済</td><td class="text-right">2,300 円</td><td>Mogami</td><td>2020/03/10</td></tr>
                        -->
                    </tbody>
                </table>
            </div>
            {# ペジネーション #}
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    {% if ringis.has_previous %}
                        <li class="page-item"><a class="page-link" href="/ringi/{{ ringis.previous_page_number }}">&laquo;</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">&laquo;</a></li>
                    {% endif %}

                    {% for page in ringis.paginator.page_range %}
                        <li class="page-item {% if page == ringis.number %} active {% endif %}"><a class="page-link" href="/ringi/{{ page }}">{{ page }}</a></li>
                    {% endfor %}
                    
                    {% if ringis.has_next %}
                        <li class="page-item"><a class="page-link" href="/ringi/{{ ringis.next_page_number }}">&raquo;</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">&raquo;</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>
</div>
{% endblock %}